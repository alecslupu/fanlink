<%#
# Navigation

This partial is used to display the navigation in Administrate.
By default, the navigation contains navigation links
for all resources in the admin dashboard,
as defined by the routes in the `admin/` namespace
%>
<nav class="navigation" role="navigation">
  <% if current_user.present? %>
    <div class="user-status">
      User: <%= current_user.username %>
      <% if current_user.super_admin? && ActsAsTenant.current_tenant.present? %>
        <div>
          Product: <%= ActsAsTenant.current_tenant.name %>
        </div>
      <% end %>
    </div>
    <hr/>
  <% end %>
  <% if current_user %>
    <% if current_user.super_admin? && !(controller.action_name == "select_form") %>
      <%= link_to "Select Product", select_form_admin_products_path, class: 'button' %>
      <hr/>
    <% end %>
    <% courses = [ 'certcourses', 'certificate_certcourses', 'certcourse_pages', 'image_pages', 'person_certcourses', 'person_certificates'] %>
    <% titles = {"certcourses" => "Courses", "certcourse_pages" => "Course Pages"} %>
    <% exceptions = courses + ['sessions'] %>
    <div style="margin-top: 25px;">
      <p><strong>Courseware</strong></p>
    </div>
    <div style="margin-top: 25px;">
      <p><strong><hr></strong></p>
    </div>
    <% courses.each do |name| %>
      <% resource = Administrate::Namespace.new(namespace).resources.detect {|e| e.resource == name } %>
      <% title = titles[name] || display_resource_name(resource).titleize %>
      <%= link_to(
            title,
            [namespace, resource_index_route_key(resource)],
            class: "navigation__link navigation__link--#{nav_link_state(resource)}"
          ) %>
    <% end %>
    <div style="margin-top: 25px;">
      <p><strong><hr></strong></p>
    </div>
    <div style="margin-top: 25px;">
      <p><strong>Other</strong></p>
    </div>
    <div style="margin-top: 25px;">
      <p><strong><hr></strong></p>
    </div>
    <% unless controller.action_name == "select_form" %>
      <% Administrate::Namespace.new(namespace).resources.each do |resource| %>
        <% unless (!current_user.super_admin? && resource.resource == "products") || exceptions.include?(resource.resource) %>
          <%= link_to(
            display_resource_name(resource).titleize,
            [namespace, resource_index_route_key(resource)],
            class: "navigation__link navigation__link--#{nav_link_state(resource)}"
          ) %>
        <% end %>
      <% end %>
    <% end %>
    <%= link_to "Logout", admin_logout_path, class: 'button' %>
  <% end %>
</nav>
