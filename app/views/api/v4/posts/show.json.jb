json = Rails.cache.fetch ["v4", @post.id, @post.updated_at] do
  {
    post: render(partial: @req_source, locals: { post: @post }, handlers: "jb")
  }
end

if defined?(@post_reaction) && @post_reaction.present?
  json[:post_reaction] =
  {
    id: @post_reaction.id,
    post_id: @post_reaction.post_id,
    person_id: @post_reaction.person_id,
    reaction: @post_reaction.reaction
  }
else
  json[:post_reaction] = nil
end

json
